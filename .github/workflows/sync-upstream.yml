name: Sync Fork with Upstream

on:
  # 允许在GitHub网页上手动触发此工作流
  workflow_dispatch:
  # 或者设置定时自动同步，例如每天UTC时间午夜运行
  schedule:
    - cron:  '0 0 * * *'

jobs:
  sync:
    runs-on: ubuntu-latest
    steps:
      # 步骤1：检出你的Fork仓库代码
      - name: Checkout
        uses: actions/checkout@v4

      # 步骤2：配置Git用户信息（必须步骤）
      - name: Setup Git
        run: |
          git config user.name "GitHub Actions Bot"
          git config user.email "actions@users.noreply.github.com"

      # 步骤3：从上游仓库获取更新并合并
      - name: Sync Upstream
        run: |
          # 添加上游仓库为远程地址
          git remote add upstream https://github.com/ValueCell-ai/valuecell.git
          # 获取上游仓库的更新
          git fetch upstream
          # 将上游仓库的main分支合并到本地的main分支
          # 使用 --rebase 参数可以保持历史线性，这里使用合并
          git merge upstream/main
          # 将合并后的结果推送到你的Fork仓库（origin）
          git push origin main
      
